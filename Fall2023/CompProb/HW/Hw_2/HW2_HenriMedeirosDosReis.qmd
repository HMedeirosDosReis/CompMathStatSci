---
title: "**Homework 2**"
subtitle: "MSSC 6010- Computational Probability"
date: today
date-format: long
author: "Henri Medeiros Dos Reis"
format: 
  pdf:
    pdf-engine: pdflatex ## have bold font
fontsize: 12pt
fontfamily: libertinus
geometry: margin=1in
documentclass: article
code-block-bg: "#202121"
highlight-style: arrow-dark
---

::: {.hidden}
\def\bx{\mathbf{x}}
\def\bX{\mathbf{X}}
\def\bg{\mathbf{g}}
\def\bw{\mathbf{w}}
\def\bb{\mathbf{b}}
\def\bu{\mathbf{u}}
\def\bbeta{\boldsymbol \beta}
\def\bgamma{\boldsymbol \gamma}
\def\bep{\boldsymbol \epsilon}
\def\bH{\mathbf{H}}
\def\bX{\mathbf{X}}
\def\by{\mathbf{y}}
\def\bH{\mathbf{H}}
\def\bI{\mathbf{I}}
\def\bS{\mathbf{S}}
\def\bU{\mathbf{U}}
\def\bV{\mathbf{V}}
\def\bW{\mathbf{W}}
\def\bD{\mathbf{D}}
\def\T{\text{T}}
\def\cov{\mathrm{Cov}}
\def\cor{\mathrm{Corr}}
\def\var{\mathrm{Var}}
\def\E{\mathrm{E}}
\def\P{\mathbb{P}}
\def\bmu{\boldsymbol \mu}
<!-- \DeclareMathOperator*{\argmin}{arg\,min} -->
\def\Trace{\text{Trace}}
:::

**Question 1.** (3.6.23) From book. Assume that $\P(A) = 0.5$, $\P(A\cap C)= 0.2$, $\P (C) = 0.4)$, $\P(B)=0.4$, $\P (A\cap B\cap C) = 0.1$, $\P (B \cap C)=0.2$, and $\P (A\cap B) = 0.2)$. Calculate the following probabilities:

- *(a)* $\P(A\cup B\cup C)$

$$
\begin{aligned}
\P(A\cup B\cup C) &= \P((A\cup B)\cup C)\\
&= \P[((A)+(B)-A\cap B)\cup C] \\
&= \P(A\cup C)+\P(B\cup C)-A\cap B\cup C \\
&= \P(A)+\P(C)-\P(A\cap C)+\P(B)+\P(C)-\P(B\cap C)-\P(A\cap B\cup C)\\
&= 0.5+0.4-0.2+0.4+0.4-0.2-\P(A\cap B\cup C)\\
&= 1.3-\P(A\cap B +C-A\cap B \cap C)\\
&= 1.3-(0.2+0.4-0.1)\\ &= 0.8
\end{aligned}
$$

- *(b)* $\P(A^c \cap (B\cup C))$

$$
\begin{aligned}
\P(A^c \cap (B\cup C)) &= \P(A^c\cap(B+C-B\cap C)) \\
&= \P(A^c\cap B+A^c\cap C-A^c\cap B\cap C)) \\
&= \P((1-A)\cap B+(1-A)\cap C-(1-A)\cap B\cap C))\\
&= \P(B)-\P(A\cap B) +\P(C)-\P(A\cap C) -(\P(B\cap C)-\P(A\cap B\cap C))\\
&= 0.4-0.2+0.4-0.2-(0.2-0.1)
\\ &= 0.3
\end{aligned}
$$


- *(c)* $\P((B\cap C)^c\cup (A \cap B)^c)$

$$
\begin{aligned}
\P((B\cap C)^c\cup (A \cap B)^c) &= \P((1-B\cap C)\cup(1-A\cap C))\\
&= \P((1-B\cap C)+(1-A\cap C)) -  \P((1-B\cap C)\cap(1-A\cap C))\\
&= 1-0.2+1-0.2 -\P((1-B\cap C)\cap(1-A\cap C)) \\
&= 1.6 - (1-\P(B\cap C\cap 1)-\P(B\cap C\cap 1)+\P(B\cap C\cap A\cap A) )\\
&= 1.6 - (1- 2\P(B\cap C)+\P(B\cap C\cap A))\\
&= 1.6-(1-2(0.2)+0.1)\\
&= 0.9
\end{aligned}
$$

- *(d)* $\P(A) - \P(A\cap C)$

$$
\begin{aligned}
\P(A) - \P(A\cap C) &= 0.5-0.2 = 0.3
\end{aligned}
$$
**Question 2:** (3.6.25) From book. Verify that $\P(F|E)$ satisfiesr the three axioms of probability. 
$$
\P(F|E) = \frac{\P(F\cap E)}{\P(E)}
$$
1-) $0 \leq \P(F|E) \leq 1$. Since $\P(F\cap E)\leq\P(E)$, because $\P(F\cap E)$ is a subset of $\P(E)$, and $0 \leq \P(E) \leq 1$. Which gives $1\geq\P(E)\geq\P(F|E)$. And since $\P(F\cap E)$ and $\P(E)$ are positive values. Then $\frac{\P(F\cap E)}{\P(E)}\geq 0$.

2-) $\P(\Omega|E) = 1$. $\frac{\P(\Omega\cap E)}{\P(E)} = \frac{\P(E)}{\P(E)} = 1$. This is because $\P(\Omega\cap E) = \P(E)$, since $\Omega$ is the whole space, and $E$ is the only limiting probability. 

3-) For any sequence of mutually exclusive events we have 
$$
\P\left(\bigcup_{i=1}^\infty E_i\right) = \sum_{i=1}^\infty\P(E_i)
$$

$$
\P\left(\bigcup_{i=1}^\infty F_i | E\right) = \P\left(\bigcup_{i=1}^\infty\frac{(F_i\cap E)}{(E)}\right)
= \P\left(\frac{\bigcup_{i=1}^\infty(F_i\cap E)}{E}\right)
$$

If all $F_i$ are mutually exclusive, then it will intersect $E$ in different parts. Therefore $F_i\cap E$and $F_j\cap E$ are also mutually exclusive for all $i\neq j$. Then 

$$
\P\left(\bigcup_{i=1}^\infty(F_i\cap E)\right) = \sum_{i=1}^\infty\P(F_i\cap E)
$$

Thus

$$
\P\left(\bigcup_{i=1}^\infty F_i | E\right) = \frac{\sum_{i=1}^\infty\P(F_i\cap E)}{\P(E)} = \sum_{i=1}^\infty\frac{\P(F_i\cap E)}{\P(E)} = \sum_{i=1}^\infty\P(F_i|E)
$$

**Question 3:** (3.6.33) From book. A salesman in a department store receives household appliances from three suppliers $I$,$I$,$III$. From previous experience, the salesman knows that $2\%$, $1\%$, and $3\%$ of the appliances from suppliers $I$,$II$,$III$, respectively, are defective. The salesman sells $35\%$ of the appliances from supplier $I$, $25\%$ from supplier $II$, and $40\%$ from supplier $III$. If an appliance randomly selected is defective, find the probability that it comes from supplier $III$. 

$$
\begin{matrix}
\P(d|I) = 0.02  && \P(d|II)=0.01    && \P(d|III) = 0.03\\
\P(I) = 0.65 && \P(II)= 0.25 && \P(III)=0.4
\end{matrix}
$$

We need to find $\P(III|d) = \frac{\P(III|d)}{\P(d)}$, let's start by finding $\P(d)$, which is the probability of defective and supplier $I$, or defective and supplier $II$, or defective and supplier $III$. Let $S$ denote the supplier. 

$$
\P(d|I) = \frac{\P(d\cap S)}{\P(S)} \Rightarrow \P(d\cap S) = \P(d|S)\P(S)
$$

Then since these events are mutually exclusive, 

$$
\begin{aligned}
\P(d) &= \P(d|I)\P(I)+\P(d|II)\P(II)+\P(d|III)\P(III) \\
&= (0.02)(0.35)+(0.01)(0.25)+(0.03)(0.4)\\
&= 0.0215
\end{aligned}
$$

$$
\begin{aligned}
\P(III|d) &= \frac{\P(III\cap d)}{\P(d)} \\
&=\frac{\P(d|III)\P(III)}{\P(d)} \\
&= \frac{(0.03)(0.4)}{0.0215} \\
&= 0.55814
\end{aligned}
$$

**Question 4:** (3.6.37) From book. John and Peter play a game with a coin such that $\P(head) = p$. The game consists of tossing a coin twice. John wins if the same result is obtained in the two tosses, and Peter wins if the two results are different. 

- *(a)* At what value of $p$ is neither of them favored by the game?

Let $\P(J)$ denote the probability of John win and $\P(P)$ denote the probability of Peter win. For John to win, the result is either Head, Head, or Tail, Tail. So $\P(J) = p^2+(1-p)^2$, and $\P(P) = 1-\P(J)$.

In order to be a fair game, $\P(J)$  need to equal $\P(P)$. And each one should win $50\%$ of the times. 

$$
\begin{aligned}
p^2+(1-p)^2 &= \frac{1}{2} \\
p^2 +1-2p+p^2 &= \frac{1}{2}\\
2p^2 -2p +\frac{1}{2} &= 0 \\
4p^2-4p+1 &= 0\\
(2p-1)^2 &= 0 \\
p &= \frac{1}{2}
\end{aligned}
$$
Therefore, for $p = \frac{1}{2}$ neither of them is favored. 


- *(b)* If $p$ is different from your answer in (a), who is favored?

Since for any $p\neq \frac{1}{2}$, $(2p-1)^2>0$, then the probability of John winning increases. 

**Question 5:** (3.6.41) From book. Two independently wealthy philatelists, Alvin and Bob, are interested in buying rare stamps at a private auction. For each stamp up for auction, given that the previous bid did no win, Alvin or Bob wins on their $i^{th}$ bid with probability $p$. Assume that Alvin always makes the first bid. 

- *(a)* Find the probability that Alvin wins the first auction. 

Let $\P(A)$ denote probability of Alvin wins, $\P(S_i)$ denote the probability of stamp being bought in bid i.\

$\P(S_i) +$  (stamp not sold in the $i-1$ bids before)$*p$, since they are independent, we can just multiply. 

$$
\P(S_i) = (1-p)^{i-1}p
$$

Then, since Alvin is making the first bid, and the events $S_i$ and $S_j$ for $i\neq j$ are mutually exclusive, we have the following

$$
\begin{aligned}
\P(A) &= \P(S_1\cup S_3\cup \dots)\\
&= \P(S_1)+ \P(S_3)+\dots\\
&= p+(1-p)^2p+(1-p)^4p+(1-p)^6p+\dots \\
&= p(1+(1-p)^2+(1-p)^4+(1-p)^6+\dots) \text{ which converges to}\\
&= p\left(\frac{1}{1-(1-p)^2}\right)
\end{aligned}
$$

**Question 6:** (3.6.44) From book. Consider tossing three fair coins. The eight possible outcomes are:

$$
HHH, HHT, HTH, HTT, THH,THT, TTH, TTT. 
$$

Define $X$ as the random variable "number of heads showing when three coins are tossed." Obtain the mean and the variance of $X$. Simulate tossing three fair coins with $10,000$ times. Compute the simulated mean and variance of $X$. Are the simulated values within $2\%$ of the theoretical answers?

$$
\begin{matrix}
X = && 0,&&1,&&2,&&3\\
\P(x) = &&\frac{1}{8}&&\frac{3}{8}&&\frac{3}{8}&&\frac{1}{8}
\end{matrix}
$$
Then the expected value is
$$
\begin{aligned}
E[X] &= \sum_xx\P(x) \\&= 0(\frac{1}{8})+1(\frac{3}{8})+2(\frac{3}{8})+3(\frac{1}{8}) \\&= 1.5
\end{aligned}
$$
and the variance is
$$
\begin{aligned}
var(X) &= E[X^2]-\mu^2\\ &= 0^2(\frac{1}{8})+1^2(\frac{3}{8})+2^2(\frac{3}{8})+3^2(\frac{1}{8})-1.5^2 \\&= 0.75
\end{aligned}
$$

Now, let's simulate it in R

```{r, results='hide', message=FALSE, warning=FALSE}
library(dplyr)
```


```{r}
set.seed(42)
n <- 10000
outcomes <- sample(0:3, n, replace=TRUE, prob=c(1/8, 3/8, 3/8, 1/8))
x <- outcomes

mean_x <- mean(x)  
var_x <- var(x)
mean_2p = between(mean_x, 1.5-0.02*1.5, 1.5+0.02*1.5)
var_2p =  between(var_x, 0.75-0.02*0.75, 0.75+0.02*0.75)
if(mean_2p)
  print("Mean value is within 2% of the theoretical answer.")
if(var_2p)
  print("Variance value is within 2% of the theoretical answer.")
```

As we can see, the simulated values are within $2\%$ of the theoretical answers. 

